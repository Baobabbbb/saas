import{_ as u}from"./preload-helper-8235fac6.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const s of e.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function a(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function o(t){if(t.ep)return;t.ep=!0;const e=a(t);fetch(t.href,e)}})();const E="modulepreload",S=function(n){return"/"+n},d={},f=function(n,a,o){if(!a||a.length===0)return n();const t=document.getElementsByTagName("link");return Promise.all(a.map(e=>{if(e=S(e),e in d)return;d[e]=!0;const s=e.endsWith(".css"),g=s?'[rel="stylesheet"]':"";if(o)for(let c=t.length-1;c>=0;c--){const l=t[c];if(l.href===e&&(!s||l.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${e}"]${g}`))return;const i=document.createElement("link");if(i.rel=s?"stylesheet":E,s||(i.as="script",i.crossOrigin=""),i.href=e,document.head.appendChild(i),s)return new Promise((c,l)=>{i.addEventListener("load",c),i.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${e}`)))})})).then(()=>n()).catch(e=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=e,window.dispatchEvent(s),!s.defaultPrevented)throw e})},m=document.getElementById("results");function r(n,a="info"){const o=document.createElement("div");o.className=`test-result ${a}`,o.innerHTML=`<strong>${new Date().toLocaleTimeString()}</strong> ${n}`,m.appendChild(o),console.log(`[${a.toUpperCase()}] ${n}`)}function p(){m.innerHTML=""}async function T(){p(),r("ğŸ” DÃ‰BUT DES TESTS SUPABASE","info");try{r("ğŸ” Test 1: VÃ©rification des variables d'environnement...","info");const n={}.VITE_SUPABASE_URL,a={}.VITE_SUPABASE_ANON_KEY;n?r(`âœ… VITE_SUPABASE_URL: ${n}`,"success"):r("âŒ VITE_SUPABASE_URL non dÃ©finie","error"),a?r(`âœ… VITE_SUPABASE_ANON_KEY prÃ©sente (${a.substring(0,20)}...)`,"success"):r("âŒ VITE_SUPABASE_ANON_KEY non dÃ©finie","error"),r("ğŸ” Test 2: Import du client Supabase...","info");let o;try{o=(await f(()=>u(()=>import("./supabaseClient-54ee3b77-fe605a77.js"),["assets/supabaseClient-54ee3b77-fe605a77.js","assets/preload-helper-8235fac6.js"]).then(e=>e.a),["assets/supabaseClient-54ee3b77.js","assets/preload-helper-8235fac6.js"])).supabase,r("âœ… Client Supabase importÃ© avec succÃ¨s","success")}catch(e){r(`âŒ Erreur d'import: ${e.message}`,"error");return}r("ğŸ” Test 3: Test de connexion Ã  Supabase...","info");try{const{data:e,error:s}=await o.from("profiles").select("count",{count:"exact",head:!0});s?(r(`âŒ Erreur de connexion: ${s.message}`,"error"),s.message.includes("CORS")?r("ğŸ’¡ SOLUTION: Ajoutez votre domaine Railway dans les origines autorisÃ©es de Supabase","warning"):s.message.includes("JWT")||s.message.includes("invalid")?r("ğŸ’¡ SOLUTION: VÃ©rifiez que VITE_SUPABASE_ANON_KEY est correcte","warning"):(s.message.includes("relation")||s.message.includes("does not exist"))&&r("ğŸ’¡ SOLUTION: CrÃ©ez la table profiles dans Supabase ou vÃ©rifiez les permissions","warning")):r("âœ… Connexion Supabase rÃ©ussie !","success")}catch(e){r(`âŒ Erreur rÃ©seau: ${e.message}`,"error")}r("ğŸ” Test 4: Test d'authentification...","info");try{const{data:{user:e},error:s}=await o.auth.getUser();s?(r(`âš ï¸ Erreur auth: ${s.message}`,"warning"),r("â„¹ï¸ Aucun utilisateur connectÃ© (normal si pas d'authentification)","info")):e?r(`âœ… Utilisateur connectÃ©: ${e.email}`,"success"):r("â„¹ï¸ Aucun utilisateur connectÃ©","info")}catch(e){r(`âŒ Erreur auth: ${e.message}`,"error")}r("ğŸ” Test 5: Test des tables...","info");const t=["profiles","creations"];for(const e of t)try{const{error:s}=await o.from(e).select("*",{count:"exact",head:!0});s?s.code==="PGRST116"?r(`âš ï¸ Table ${e}: RLS actif (normal)`,"warning"):r(`âŒ Table ${e}: ${s.message}`,"error"):r(`âœ… Table ${e}: Accessible`,"success")}catch(s){r(`âŒ Erreur table ${e}: ${s.message}`,"error")}r("ğŸ” Test 6: Test de crÃ©ation (mode test)...","info");try{const e={type:"test",title:"Test de connexion",data:{test:!0,timestamp:new Date().toISOString()}},s=await(await f(()=>u(()=>import("./creations-4ab0b6d9-8e2aae55.js"),["assets/creations-4ab0b6d9-8e2aae55.js","assets/supabaseClient-54ee3b77-fe605a77.js","assets/preload-helper-8235fac6.js"]),["assets/creations-4ab0b6d9.js","assets/supabaseClient-54ee3b77.js","assets/preload-helper-8235fac6.js"])).addCreation(e);s.error?(r(`âš ï¸ CrÃ©ation test: ${s.error} (probablement mode localStorage)`,"warning"),r("â„¹ï¸ C'est normal si Supabase n'est pas configurÃ© - l'app utilise localStorage","info")):(r("âœ… CrÃ©ation test rÃ©ussie !","success"),r("ğŸ‰ Supabase fonctionne parfaitement !","success"))}catch(e){r(`âŒ Erreur test crÃ©ation: ${e.message}`,"error")}}catch(n){r(`ğŸ’¥ Erreur gÃ©nÃ©rale: ${n.message}`,"error")}r("ğŸ TESTS TERMINÃ‰S","info"),r("ğŸ“‹ Consultez la console pour plus de dÃ©tails","info")}window.runTests=T;window.clearResults=p;r('ğŸ”„ Page chargÃ©e - Cliquez sur "Lancer les tests" pour commencer',"info");export{f as p};
