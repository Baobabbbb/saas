import{p as o,_ as i}from"./preload-helper-8235fac6-22690dc2.js";const c=document.getElementById("results");function e(a,n="info"){const r=document.createElement("div");r.className=`test-result ${n}`,r.innerHTML=`<strong>${new Date().toLocaleTimeString()}</strong> ${a}`,c.appendChild(r),console.log(`[${n.toUpperCase()}] ${a}`)}function u(){c.innerHTML=""}async function d(){u(),e("ğŸ” DÃ‰BUT DES TESTS SUPABASE","info");try{e("ğŸ” Test 1: VÃ©rification des variables d'environnement...","info");const a={}.VITE_SUPABASE_URL,n={}.VITE_SUPABASE_ANON_KEY;a?e(`âœ… VITE_SUPABASE_URL: ${a}`,"success"):e("âŒ VITE_SUPABASE_URL non dÃ©finie","error"),n?e(`âœ… VITE_SUPABASE_ANON_KEY prÃ©sente (${n.substring(0,20)}...)`,"success"):e("âŒ VITE_SUPABASE_ANON_KEY non dÃ©finie","error"),e("ğŸ” Test 2: Import du client Supabase...","info");let r;try{r=(await o(()=>i(()=>import("./supabaseClient-54ee3b77-3619cb53.js"),["assets/supabaseClient-54ee3b77-3619cb53.js","assets/preload-helper-8235fac6-22690dc2.js"]).then(s=>s.a),["assets/supabaseClient-54ee3b77.js","assets/preload-helper-8235fac6.js"])).supabase,e("âœ… Client Supabase importÃ© avec succÃ¨s","success")}catch(s){e(`âŒ Erreur d'import: ${s.message}`,"error");return}e("ğŸ” Test 3: Test de connexion Ã  Supabase...","info");try{const{data:s,error:t}=await r.from("profiles").select("count",{count:"exact",head:!0});t?(e(`âŒ Erreur de connexion: ${t.message}`,"error"),t.message.includes("CORS")?e("ğŸ’¡ SOLUTION: Ajoutez votre domaine Railway dans les origines autorisÃ©es de Supabase","warning"):t.message.includes("JWT")||t.message.includes("invalid")?e("ğŸ’¡ SOLUTION: VÃ©rifiez que VITE_SUPABASE_ANON_KEY est correcte","warning"):(t.message.includes("relation")||t.message.includes("does not exist"))&&e("ğŸ’¡ SOLUTION: CrÃ©ez la table profiles dans Supabase ou vÃ©rifiez les permissions","warning")):e("âœ… Connexion Supabase rÃ©ussie !","success")}catch(s){e(`âŒ Erreur rÃ©seau: ${s.message}`,"error")}e("ğŸ” Test 4: Test d'authentification...","info");try{const{data:{user:s},error:t}=await r.auth.getUser();t?(e(`âš ï¸ Erreur auth: ${t.message}`,"warning"),e("â„¹ï¸ Aucun utilisateur connectÃ© (normal si pas d'authentification)","info")):s?e(`âœ… Utilisateur connectÃ©: ${s.email}`,"success"):e("â„¹ï¸ Aucun utilisateur connectÃ©","info")}catch(s){e(`âŒ Erreur auth: ${s.message}`,"error")}e("ğŸ” Test 5: Test des tables...","info");const l=["profiles","creations"];for(const s of l)try{const{error:t}=await r.from(s).select("*",{count:"exact",head:!0});t?t.code==="PGRST116"?e(`âš ï¸ Table ${s}: RLS actif (normal)`,"warning"):e(`âŒ Table ${s}: ${t.message}`,"error"):e(`âœ… Table ${s}: Accessible`,"success")}catch(t){e(`âŒ Erreur table ${s}: ${t.message}`,"error")}e("ğŸ” Test 6: Test de crÃ©ation (mode test)...","info");try{const s={type:"test",title:"Test de connexion",data:{test:!0,timestamp:new Date().toISOString()}},t=await(await o(()=>i(()=>import("./creations-4ab0b6d9-52219f91.js"),["assets/creations-4ab0b6d9-52219f91.js","assets/supabaseClient-54ee3b77-3619cb53.js","assets/preload-helper-8235fac6-22690dc2.js"]),["assets/creations-4ab0b6d9.js","assets/supabaseClient-54ee3b77.js","assets/preload-helper-8235fac6.js"])).addCreation(s);t.error?(e(`âš ï¸ CrÃ©ation test: ${t.error} (probablement mode localStorage)`,"warning"),e("â„¹ï¸ C'est normal si Supabase n'est pas configurÃ© - l'app utilise localStorage","info")):(e("âœ… CrÃ©ation test rÃ©ussie !","success"),e("ğŸ‰ Supabase fonctionne parfaitement !","success"))}catch(s){e(`âŒ Erreur test crÃ©ation: ${s.message}`,"error")}}catch(a){e(`ğŸ’¥ Erreur gÃ©nÃ©rale: ${a.message}`,"error")}e("ğŸ TESTS TERMINÃ‰S","info"),e("ğŸ“‹ Consultez la console pour plus de dÃ©tails","info")}window.runTests=d;window.clearResults=u;e('ğŸ”„ Page chargÃ©e - Cliquez sur "Lancer les tests" pour commencer',"info");
