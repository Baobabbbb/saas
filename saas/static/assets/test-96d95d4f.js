import{_ as i}from"./preload-helper-8235fac6.js";const c=document.getElementById("results");function e(a,n="info"){const t=document.createElement("div");t.className=`test-result ${n}`,t.innerHTML=`<strong>${new Date().toLocaleTimeString()}</strong> ${a}`,c.appendChild(t),console.log(`[${n.toUpperCase()}] ${a}`)}function u(){c.innerHTML=""}async function d(){u(),e("🔍 DÉBUT DES TESTS SUPABASE","info");try{e("🔍 Test 1: Vérification des variables d'environnement...","info");const a={}.VITE_SUPABASE_URL,n={}.VITE_SUPABASE_ANON_KEY;a?e(`✅ VITE_SUPABASE_URL: ${a}`,"success"):e("❌ VITE_SUPABASE_URL non définie","error"),n?e(`✅ VITE_SUPABASE_ANON_KEY présente (${n.substring(0,20)}...)`,"success"):e("❌ VITE_SUPABASE_ANON_KEY non définie","error"),e("🔍 Test 2: Import du client Supabase...","info");let t;try{t=(await i(()=>import("./supabaseClient-76c3910e.js").then(r=>r.a),["assets/supabaseClient-76c3910e.js","assets/preload-helper-8235fac6.js"])).supabase,e("✅ Client Supabase importé avec succès","success")}catch(s){e(`❌ Erreur d'import: ${s.message}`,"error");return}e("🔍 Test 3: Test de connexion à Supabase...","info");try{const{data:s,error:r}=await t.from("profiles").select("count",{count:"exact",head:!0});r?(e(`❌ Erreur de connexion: ${r.message}`,"error"),r.message.includes("CORS")?e("💡 SOLUTION: Ajoutez votre domaine Railway dans les origines autorisées de Supabase","warning"):r.message.includes("JWT")||r.message.includes("invalid")?e("💡 SOLUTION: Vérifiez que VITE_SUPABASE_ANON_KEY est correcte","warning"):(r.message.includes("relation")||r.message.includes("does not exist"))&&e("💡 SOLUTION: Créez la table profiles dans Supabase ou vérifiez les permissions","warning")):e("✅ Connexion Supabase réussie !","success")}catch(s){e(`❌ Erreur réseau: ${s.message}`,"error")}e("🔍 Test 4: Test d'authentification...","info");try{const{data:{user:s},error:r}=await t.auth.getUser();r?(e(`⚠️ Erreur auth: ${r.message}`,"warning"),e("ℹ️ Aucun utilisateur connecté (normal si pas d'authentification)","info")):s?e(`✅ Utilisateur connecté: ${s.email}`,"success"):e("ℹ️ Aucun utilisateur connecté","info")}catch(s){e(`❌ Erreur auth: ${s.message}`,"error")}e("🔍 Test 5: Test des tables...","info");const l=["profiles","creations"];for(const s of l)try{const{error:r}=await t.from(s).select("*",{count:"exact",head:!0});r?r.code==="PGRST116"?e(`⚠️ Table ${s}: RLS actif (normal)`,"warning"):e(`❌ Table ${s}: ${r.message}`,"error"):e(`✅ Table ${s}: Accessible`,"success")}catch(r){e(`❌ Erreur table ${s}: ${r.message}`,"error")}e("🔍 Test 6: Test de création (mode test)...","info");try{const s={type:"test",title:"Test de connexion",data:{test:!0,timestamp:new Date().toISOString()}},o=await(await i(()=>import("./creations-822d4935.js"),["assets/creations-822d4935.js","assets/supabaseClient-76c3910e.js","assets/preload-helper-8235fac6.js"])).addCreation(s);o.error?(e(`⚠️ Création test: ${o.error} (probablement mode localStorage)`,"warning"),e("ℹ️ C'est normal si Supabase n'est pas configuré - l'app utilise localStorage","info")):(e("✅ Création test réussie !","success"),e("🎉 Supabase fonctionne parfaitement !","success"))}catch(s){e(`❌ Erreur test création: ${s.message}`,"error")}}catch(a){e(`💥 Erreur générale: ${a.message}`,"error")}e("🏁 TESTS TERMINÉS","info"),e("📋 Consultez la console pour plus de détails","info")}window.runTests=d;window.clearResults=u;e('🔄 Page chargée - Cliquez sur "Lancer les tests" pour commencer',"info");
